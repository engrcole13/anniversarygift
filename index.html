import React, { useState, useEffect } from 'react';
import { Heart, Lock, Calendar, Clock, Stars, Image as ImageIcon, BookOpen, Gift } from 'lucide-react';

// --- CONFIGURATION ---
// CHANGE THESE VALUES TO CUSTOMIZE YOUR SITE
const CONFIG = {
  // Your Anniversary Date (The day you officially started dating)
  anniversaryDate: "2024-11-28T00:00:00",

  // The passcode she needs to enter (MMDDYY of your date)
  passcode: "112824",

  // Texts
  loginTitle: "Entrance to Our World",
  loginPlaceholder: "Enter our special date (MMDDYY)",
  greeting: "Happy Anniversary, Kath!",
  welcomeMsg: "Welcome to our special corner of the internet.",

  // Letter Content
  letterTitle: "My Dearest Kath,",
  letterBody: "I wanted to create something special just for you. This time with you, despite the miles that often separate us, has been the best of my life.\n\nWhether we're celebrating this day together in person or miles apart, my heart is always with you. Every day is a new adventure, and I can't wait to permanently close the distance.\n\nI love you more than words can say.",
  loveNote: "Forever & Always, Cole",

  // "Why I Love You" Reasons (Mixed with LDR themes)
  reasons: [
    "Your infectious laugh that brightens my day, even over a choppy video call.",
    "How you make thousands of miles feel like nothing at all.",
    "Your patience and commitment to 'us', no matter the distance.",
    "The excitement I feel counting down the days until I see you next.",
    "How safe and loved I feel with you, even when you're far away.",
    "Simply because you are you."
  ],

  // Timeline Milestones
  timeline: [
    {
      date: "Nov 28, 2023",
      title: "The First Hello",
      description: "Our very first meet-up when you had your concert here in Metro Manila. Seeing you in person changed everything."
    },
    {
      date: "July 28, 2024",
      title: "Magic in Baguio",
      description: "Our second meet-up! It was planned trip to Baguio City. It was my first time there, and I enjoyed every moment simply because I was exploring it with you."
    },
    {
      date: "Nov 28, 2024",
      title: "Officially Us",
      description: "After knowing each other for 3 years, we let fate (and a spinning wheel!) decide our official start. It’s funny, perfect, and exactly 'us'—officially beginning on the same day we first met a year prior."
    },
    {
      date: "July 2, 2025",
      title: "Your Big Day",
      description: "I traveled to your hometown for the very first time to see you graduate. I was so incredibly proud of you that day."
    },
    {
      date: "Oct 10, 2025",
      title: "Welcome Home",
      description: "You just arrived from your concert in Rome. I picked you up at the airport, and you stayed in my apartment for the first time with my mom there too. I'm so happy our families are connecting."
    },
    {
      date: "Today & Forever",
      title: "The Next Chapter",
      description: "I don't know exactly what the future holds when you read this, but I am so looking forward to the next exciting chapter of our story together."
    }
  ],

  // Photo Gallery (Replace these URLs with actual links to your photos)
  // You can use free image hosting if you don't have them online.
  galleryImages: [
    "https://placehold.co/600x400/pink/white?text=Concert+Meetup",
    "https://placehold.co/400x600/red/white?text=Baguio+Trip",
    "https://placehold.co/500x500/orange/white?text=Spinning+Wheel!",
    "https://placehold.co/600x800/pink/white?text=Graduation+Day",
    "https://placehold.co/800x600/red/white?text=Airport+Pickup",
    "https://placehold.co/400x400/orange/white?text=Us+Always"
  ]
};

function App() {
  const [isLoggedIn, setIsLoggedIn] = useState(false);

  useEffect(() => {
    const savedLogin = localStorage.getItem('anniversary_login_cole_kath');
    if (savedLogin === 'true') {
      setIsLoggedIn(true);
    }
  }, []);

  const handleLoginSuccess = () => {
    setIsLoggedIn(true);
    localStorage.setItem('anniversary_login_cole_kath', 'true');
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-pink-100 via-red-50 to-pink-200 text-gray-800 font-sans overflow-hidden relative">
      {/* Background Floating Hearts */}
      <div className="fixed inset-0 pointer-events-none overflow-hidden z-0">
        {[...Array(20)].map((_, i) => (
          <div
            key={i}
            className="heart-animation absolute text-pink-300 opacity-50"
            style={{
              left: `${Math.random() * 100}%`,
              animationDelay: `${Math.random() * 5}s`,
              fontSize: `${Math.random() * 20 + 10}px`
            }}
          >
            <Heart fill="currentColor" />
          </div>
        ))}
      </div>

      <div className="relative z-10">
        {!isLoggedIn ? (
          <LoginPage onLogin={handleLoginSuccess} />
        ) : (
          <MainPage />
        )}
      </div>

      <style>{`
        @keyframes floatUp {
          0% { transform: translateY(100vh) scale(0.5); opacity: 0; }
          20% { opacity: 0.7; }
          100% { transform: translateY(-10vh) scale(1.2) rotate(360deg); opacity: 0; }
        }
        .heart-animation {
          bottom: -10vh;
          animation: floatUp 15s linear infinite;
        }
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(20px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
          animation: fadeIn 1s ease-out forwards;
        }
        .perspective-1000 {
          perspective: 1000px;
        }
        .transform-style-3d {
          transform-style: preserve-3d;
        }
        .backface-hidden {
          backface-visibility: hidden;
        }
        .rotate-y-180 {
          transform: rotateY(180deg);
        }
      `}</style>
    </div>
  );
}

// --- LOGIN PAGE COMPONENT ---
function LoginPage({ onLogin }) {
  const [input, setInput] = useState('');
  const [error, setError] = useState('');

  const handleSubmit = (e) => {
    e.preventDefault();
    if (input === CONFIG.passcode) {
      onLogin();
    } else {
      setError("Oops! That's not our special date. Try again! Hint: MMDDYY");
      setInput('');
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center p-4">
      <div className="bg-white/80 backdrop-blur-md p-8 rounded-2xl shadow-xl max-w-md w-full border border-pink-100 fade-in">
        <div className="flex justify-center mb-6 text-pink-500">
          <Lock size={48} />
        </div>
        <h1 className="text-2xl font-bold text-center text-pink-600 mb-6 font-serif">
          {CONFIG.loginTitle}
        </h1>
        <form onSubmit={handleSubmit} className="space-y-4">
          <input
            type="password"
            inputMode="numeric"
            pattern="[0-9]*"
            value={input}
            onChange={(e) => setInput(e.target.value)}
            placeholder={CONFIG.loginPlaceholder}
            className="w-full px-4 py-3 rounded-lg border border-pink-200 focus:border-pink-500 focus:ring-2 focus:ring-pink-200 outline-none transition text-center text-lg tracking-widest"
            autoFocus
          />
          {error && <p className="text-red-500 text-sm text-center animate-pulse">{error}</p>}
          <button
            type="submit"
            className="w-full bg-pink-500 hover:bg-pink-600 text-white font-bold py-3 px-4 rounded-lg transition duration-300 ease-in-out transform hover:scale-[1.02] flex items-center justify-center gap-2"
          >
            Unlock Our Memories <Heart size={20} fill="currentColor" />
          </button>
        </form>
      </div>
    </div>
  );
}

// --- MAIN PAGE COMPONENT ---
function MainPage() {
  const [timeTogether, setTimeTogether] = useState({ days: 0, hours: 0, minutes: 0, seconds: 0 });

  useEffect(() => {
    const interval = setInterval(() => {
      const start = new Date(CONFIG.anniversaryDate);
      const now = new Date();
      const diff = now - start;
      setTimeTogether({
        days: Math.floor(diff / (1000 * 60 * 60 * 24)),
        hours: Math.floor((diff / (1000 * 60 * 60)) % 24),
        minutes: Math.floor((diff / 1000 / 60) % 60),
        seconds: Math.floor((diff / 1000) % 60)
      });
    }, 1000);
    return () => clearInterval(interval);
  }, []);

  return (
    <div className="container mx-auto px-4 py-12 min-h-screen overflow-y-auto">
      <div className="max-w-4xl mx-auto space-y-16 fade-in pb-20">

        {/* HEADER */}
        <header className="text-center space-y-4 pt-10">
          <div className="inline-block p-3 bg-pink-100 rounded-full text-pink-500 mb-4 animate-bounce">
            <Stars size={32} />
          </div>
          <h1 className="text-4xl md:text-6xl font-bold text-pink-600 font-serif leading-tight">
            {CONFIG.greeting}
          </h1>
          <p className="text-xl text-pink-400">{CONFIG.welcomeMsg}</p>
        </header>

        {/* TIMER */}
        <Section title="Time Since We Officially Started" icon={<Clock className="text-pink-500" />}>
           <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
            <TimeBox value={timeTogether.days} label="Days" />
            <TimeBox value={timeTogether.hours} label="Hours" />
            <TimeBox value={timeTogether.minutes} label="Minutes" />
            <TimeBox value={timeTogether.seconds} label="Seconds" />
          </div>
        </Section>

        {/* LETTER */}
        <Section>
          <div className="prose max-w-none font-serif">
            <h2 className="text-3xl text-pink-600 mb-6">{CONFIG.letterTitle}</h2>
            <p className="text-lg text-gray-700 leading-relaxed whitespace-pre-wrap mb-8">
              {CONFIG.letterBody}
            </p>
            <p className="text-xl font-bold text-pink-500 text-right font-handwriting">
              {CONFIG.loveNote}
            </p>
          </div>
        </Section>

        {/* WHY I LOVE YOU CARDS */}
        <Section title="Reasons Why I Love You" icon={<Heart className="text-red-500" fill="currentColor" />}>
          <div className="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4">
            {CONFIG.reasons.map((reason, index) => (
              <FlipCard key={index} front={`Reason #${index + 1}`} back={reason} />
            ))}
          </div>
        </Section>

        {/* TIMELINE */}
        <Section title="Our LDR Journey" icon={<Calendar className="text-pink-500" />}>
          <div className="relative border-l-4 border-pink-200 ml-3 pl-8 space-y-8">
            {CONFIG.timeline.map((item, index) => (
              <div key={index} className="relative">
                <div className="absolute -left-[42px] bg-pink-500 w-6 h-6 rounded-full border-4 border-white shadow-sm"></div>
                <div className="bg-pink-50 p-4 rounded-xl shadow-sm">
                  <span className="text-sm font-bold text-pink-400">{item.date}</span>
                  <h3 className="text-xl font-bold text-gray-800 mt-1">{item.title}</h3>
                  <p className="text-gray-600 mt-2">{item.description}</p>
                </div>
              </div>
            ))}
          </div>
        </Section>

        {/* PHOTO GALLERY */}
        <Section title="Our Memories" icon={<ImageIcon className="text-pink-500" />}>
          <div className="columns-1 sm:columns-2 md:columns-3 gap-4 space-y-4">
            {CONFIG.galleryImages.map((src, index) => (
              <div key={index} className="break-inside-avoid rounded-xl overflow-hidden shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1">
                <img src={src} alt="Us" className="w-full h-auto object-cover" loading="lazy" />
              </div>
            ))}
          </div>
        </Section>

        <footer className="text-center text-pink-300 text-sm opacity-80">
          Made with ❤️ by Cole for Kath
        </footer>

      </div>
    </div>
  );
}

// --- HELPER COMPONENTS ---

function Section({ title, icon, children }) {
  return (
    <section className="bg-white/80 backdrop-blur-md rounded-3xl p-6 md:p-10 shadow-xl border border-pink-100">
      {title && (
        <h2 className="text-2xl md:text-3xl font-bold text-center text-gray-700 mb-8 flex items-center justify-center gap-3 font-serif">
          {icon} {title}
        </h2>
      )}
      {children}
    </section>
  );
}

function TimeBox({ value, label }) {
  return (
    <div className="bg-gradient-to-b from-pink-50 to-white p-4 rounded-2xl border border-pink-100 shadow-sm">
      <div className="text-3xl md:text-5xl font-bold text-pink-600 tabular-nums">
        {value}
      </div>
      <div className="text-pink-400 text-xs md:text-sm uppercase tracking-widest font-semibold mt-1">
        {label}
      </div>
    </div>
  );
}

function FlipCard({ front, back }) {
  const [isFlipped, setIsFlipped] = useState(false);

  return (
    <div
      className="h-40 cursor-pointer perspective-1000"
      onClick={() => setIsFlipped(!isFlipped)}
    >
      <div className={`relative w-full h-full transition-transform duration-500 transform-style-3d ${isFlipped ? 'rotate-y-180' : ''}`}>
        {/* Front */}
        <div className="absolute w-full h-full bg-pink-500 rounded-xl flex items-center justify-center p-4 text-white font-bold text-xl backface-hidden shadow-lg hover:bg-pink-600 transition-colors">
          {front}
          <Gift className="ml-2 opacity-50" size={20} />
        </div>
        {/* Back */}
        <div className="absolute w-full h-full bg-white rounded-xl flex items-center justify-center p-4 text-pink-600 text-center font-medium border-2 border-pink-500 rotate-y-180 backface-hidden shadow-lg overflow-y-auto">
         {back}
        </div>
      </div>
    </div>
  );
}

export default App;
